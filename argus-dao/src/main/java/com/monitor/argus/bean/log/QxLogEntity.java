package com.monitor.argus.bean.log;

import com.alibaba.druid.support.json.JSONUtils;
import com.google.common.collect.Lists;
import com.google.common.collect.Maps;
import com.monitor.argus.common.util.ArgusUtils;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

/**
 * @author alexzhang
 * @date 2020/7/20 12:39
 */
public class QxLogEntity {
    static String key="{\"protocol\":{\"type\":\"data_increment_data\",\"version\":\"v1\",\"msg_id\":-1,\"msg_prev_id\":-1},\"schema\":{\"namespace\":\"kafka.kafka139.top-argusn.qxstock.1318659577.0.0\",\"fields\":[{\"name\":\"ums_ts_\",\"type\":\"datetime\",\"nullable\":true},{\"name\":\"ums_id_\",\"type\":\"long\",\"nullable\":true},{\"name\":\"ums_op_\",\"type\":\"string\",\"nullable\":true},{\"name\":\"log\",\"type\":\"string\",\"nullable\":true},{\"name\":\"ctm\",\"type\":\"string\",\"nullable\":true},{\"name\":\"ctms\",\"type\":\"string\",\"nullable\":true},{\"name\":\"file\",\"type\":\"string\",\"nullable\":true},{\"name\":\"insid\",\"type\":\"string\",\"nullable\":true},{\"name\":\"log_ip\",\"type\":\"string\",\"nullable\":true},{\"name\":\"lid\",\"type\":\"string\",\"nullable\":true},{\"name\":\"lnm\",\"type\":\"string\",\"nullable\":true},{\"name\":\"path\",\"type\":\"string\",\"nullable\":true},{\"name\":\"snm\",\"type\":\"string\",\"nullable\":true}]},\"payload\":[{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968709888\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator.sendHeartBeat(EurekaHttpClientDecorator.java:89) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779090133017\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968710144\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator$3.execute(EurekaHttpClientDecorator.java:92) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779090133018\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968710400\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.SessionedEurekaHttpClient.execute(SessionedEurekaHttpClient.java:77) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779090133019\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968710656\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator.sendHeartBeat(EurekaHttpClientDecorator.java:89) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779090133020\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968710912\",\"i\",\"\\tat com.netflix.discovery.DiscoveryClient.renew(DiscoveryClient.java:864) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779090133021\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968711168\",\"i\",\"\\tat com.netflix.discovery.DiscoveryClient$HeartbeatThread.run(DiscoveryClient.java:1423) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779090133022\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968711424\",\"i\",\"\\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_201]\",\"104544779090133023\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968711680\",\"i\",\"\\tat java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_201]\",\"104544779090133024\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968711936\",\"i\",\"\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_201]\",\"104544779090133025\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968712192\",\"i\",\"\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_201]\",\"104544779090133026\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:11.722\",\"469874168968712448\",\"i\",\"\\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_201]\",\"104544779090133027\",\"1595226731722\",\"trade.log\",\"792\",\"66.66.38.30\",\"1\",\"qxstock\",\"/logs/nxs-trade2-6b775c464c-m7vmr/trade/logs/trade.log\",\"nxs-trade2\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294406144\",\"i\",\"2020-07-20 14:32:11.780 ERROR c.s.j.a.c.ClientResponse A message body reader for Java class com.netflix.appinfo.InstanceInfo, and Java type class com.netflix.appinfo.InstanceInfo, and MIME media type text/html; charset=utf-8 was not found\",\"104544779220221952\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294406400\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.StringProvider\",\"104544779220221956\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294406656\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.FormProvider\",\"104544779220221955\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294406912\",\"i\",\"*/* ->\",\"104544779220221954\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294407168\",\"i\",\"2020-07-20 14:32:11.780 ERROR c.s.j.a.c.ClientResponse The registered message body readers compatible with the MIME media type are:\",\"104544779220221953\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294407424\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.ByteArrayProvider\",\"104544779220221957\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294407680\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.FileProvider\",\"104544779220221958\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294407936\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.InputStreamProvider\",\"104544779220221959\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294408192\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.DataSourceProvider\",\"104544779220221960\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294408448\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.XMLJAXBElementProvider$General\",\"104544779220221961\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294408704\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.ReaderProvider\",\"104544779220221962\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294408960\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.DocumentProvider\",\"104544779220221963\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294409216\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.SourceProvider$StreamSourceReader\",\"104544779220221964\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294409472\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.SourceProvider$SAXSourceReader\",\"104544779220221965\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294409728\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.SourceProvider$DOMSourceReader\",\"104544779220221966\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294409984\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.XMLRootElementProvider$General\",\"104544779220221967\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294410240\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.XMLListElementProvider$General\",\"104544779220221968\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294410496\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.XMLRootObjectProvider$General\",\"104544779220221969\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294410752\",\"i\",\"  com.sun.jersey.core.impl.provider.entity.EntityHolderReader\",\"104544779220221970\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294411008\",\"i\",\"  com.alibaba.fastjson.support.jaxrs.FastJsonProvider\",\"104544779220221971\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294411264\",\"i\",\"2020-07-20 14:32:11.780 ERROR c.n.d.s.t.d.RedirectingEurekaHttpClient Request execution error. endpoint=DefaultEndpoint{ serviceUrl='http://admin:nxsadmin@nxs-eureka.jishu.idc/eureka/}\",\"104544779220221972\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294411520\",\"i\",\"com.sun.jersey.api.client.ClientHandlerException: A message body reader for Java class com.netflix.appinfo.InstanceInfo, and Java type class com.netflix.appinfo.InstanceInfo, and MIME media type text/html; charset=utf-8 was not found\",\"104544779220221973\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294411776\",\"i\",\"\\tat com.sun.jersey.api.client.ClientResponse.getEntity(ClientResponse.java:630) ~[jersey-client-1.19.1.jar!/:1.19.1]\",\"104544779220221974\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294412032\",\"i\",\"\\tat com.sun.jersey.api.client.ClientResponse.getEntity(ClientResponse.java:586) ~[jersey-client-1.19.1.jar!/:1.19.1]\",\"104544779220221975\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294412288\",\"i\",\"\\tat com.netflix.discovery.shared.transport.jersey.AbstractJerseyEurekaHttpClient.sendHeartBeat(AbstractJerseyEurekaHttpClient.java:105) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221976\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294412544\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator$3.execute(EurekaHttpClientDecorator.java:92) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221977\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294412800\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.MetricsCollectingEurekaHttpClient.execute(MetricsCollectingEurekaHttpClient.java:73) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221978\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294413056\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator.sendHeartBeat(EurekaHttpClientDecorator.java:89) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221979\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294413312\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator$3.execute(EurekaHttpClientDecorator.java:92) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221980\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294413568\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.RedirectingEurekaHttpClient.executeOnNewServer(RedirectingEurekaHttpClient.java:118) ~[eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221981\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294413824\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.RedirectingEurekaHttpClient.execute(RedirectingEurekaHttpClient.java:79) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221982\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294414080\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator.sendHeartBeat(EurekaHttpClientDecorator.java:89) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221983\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294414336\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator$3.execute(EurekaHttpClientDecorator.java:92) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221984\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294414592\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.RetryableEurekaHttpClient.execute(RetryableEurekaHttpClient.java:120) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221985\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294414848\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator.sendHeartBeat(EurekaHttpClientDecorator.java:89) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221986\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294415104\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator$3.execute(EurekaHttpClientDecorator.java:92) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221987\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294415360\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.SessionedEurekaHttpClient.execute(SessionedEurekaHttpClient.java:77) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221988\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294415616\",\"i\",\"\\tat com.netflix.discovery.shared.transport.decorator.EurekaHttpClientDecorator.sendHeartBeat(EurekaHttpClientDecorator.java:89) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221989\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]},{\"tuple\":[\"2020-07-20 14:32:13.707\",\"469874177294415872\",\"i\",\"\\tat com.netflix.discovery.DiscoveryClient.renew(DiscoveryClient.java:864) [eureka-client-1.9.12.jar!/:1.9.12]\",\"104544779220221990\",\"1595226733707\",\"trade.log\",\"4182\",\"66.66.72.17\",\"1\",\"qxstock\",\"/logs/nxs-trade1-67d46b989b-ktrss/trade/logs/trade.log\",\"nxs-trade1\"]}]}";
    public static void main(String[] args) {

        Map<String, Object> jsonObject= (Map<String, Object>) JSONUtils.parse(key);

        Object o=parse(jsonObject);
        System.out.println("aaa");
    }
    private ArrayList<Tuple> payload;

    public ArrayList<Tuple> getPayload() {
        return payload;
    }
    private static ArrayList<LogEntityDTO> parse(Map<String, Object> jsonObject) {
        ArrayList<LogEntityDTO> entityDTOS= Lists.newArrayList();
        Map<String,Integer> index=parseIndex(jsonObject);
        List loads= (ArrayList) jsonObject.get("payload");
        for(Object map:loads){
            Map m= (Map) map;
            List list= (List) m.get("tuple");
            String nameOrIp= (String) list.get(index.get(ArgusUtils.KEY_QUEXIN_LOG_SYS_NAME));
            String log= (String) list.get(index.get(ArgusUtils.KEY_QUEXIN_LOG_TXT));
            String time= (String) list.get(index.get(ArgusUtils.KEY_QUEXIN_LOG_TIMESTAMP));
            LogEntityDTO bean=new LogEntityDTO();
            bean.setFullMessage(log);
            bean.setTimeStamp(time);
            bean.setIp(nameOrIp);
            entityDTOS.add(bean);
        }
        return entityDTOS;
    }

    private static Map<String,Integer> parseIndex(Map<String, Object> jsonObject){
        Map<String,Integer> index= Maps.newHashMap();
        List fields= (List) ((Map)jsonObject.get("schema")).get("fields");
        for(int i=0;i<fields.size();i++){
            Map item= (Map) fields.get(i);
            String name= (String) item.get("name");
            if("ums_ts_".equals(name)){
                index.put(ArgusUtils.KEY_QUEXIN_LOG_TIMESTAMP, 0);
            }
            if("log".equals(name)){
                index.put(ArgusUtils.KEY_QUEXIN_LOG_TXT, 3);
            }
            if("snm".equals(name)){
                index.put(ArgusUtils.KEY_QUEXIN_LOG_SYS_NAME, 12);
            }
        }
        return index;
    }
    public void setPayload(ArrayList<Tuple> payload) {
        this.payload = payload;
    }
}